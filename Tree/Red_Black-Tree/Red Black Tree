This is Red Black Tree function.

More details please see Introduction to Algorithms.
